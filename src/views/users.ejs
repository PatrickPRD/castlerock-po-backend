<%- include('partials/head', { pageTitle: 'Users', styles: ['admin.css'] }) %>
<%- include('partials/header', { pageTitle: 'Users' }) %>

<main class="container">

  <div class="card" id="usersSection">
    <div class="card-header">
      <h3>Users</h3>
      <button class="btn btn-primary" id="openAddUser">Add User</button>
    </div>

    <table class="po-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Role</th>
          <th>Status</th>
          <th class="actions-col"></th>
        </tr>
      </thead>
      <tbody id="userTable"></tbody>
    </table>
  </div>

  <div class="modal" id="addUserModal" style="display:none;">
    <div class="modal-content" style="width: 640px;">
      <div class="modal-header">
        <h3 id="addUserTitle">Add User</h3>
        <button class="modal-close" type="button" data-modal-close="addUserModal">x</button>
      </div>
      <form id="addUserForm" class="modal-body">
        <div class="form-grid">
          <input id="addFirstName" placeholder="First name" required>
          <input id="addLastName" placeholder="Last name" required>
          <input id="addEmail" placeholder="Email" type="email" required>
          <select id="addRole" required>
            <option value="admin">Admin</option>
            <option value="staff">Staff</option>
            <option value="viewer">Viewer</option>
          </select>
        </div>
        <div class="modal-actions">
          <button class="btn btn-outline-secondary" type="button" data-modal-close="addUserModal">Cancel</button>
          <button class="btn btn-primary" type="submit">Create User</button>
        </div>
      </form>
    </div>
  </div>

  <div class="modal" id="editUserModal" style="display:none;">
    <div class="modal-content" style="width: 640px;">
      <div class="modal-header">
        <h3 id="editUserTitle">Edit User</h3>
        <button class="modal-close" type="button" data-modal-close="editUserModal">x</button>
      </div>
      <form id="editUserForm" class="modal-body">
        <input type="hidden" id="editUserId">
        <div class="form-grid">
          <input id="editFirstName" placeholder="First name" required>
          <input id="editLastName" placeholder="Last name" required>
          <input id="editEmail" placeholder="Email" type="email" disabled>
          <select id="editRole" required>
            <option value="super_admin">Super Admin</option>
            <option value="admin">Admin</option>
            <option value="staff">Staff</option>
            <option value="viewer">Viewer</option>
          </select>
          <select id="editActive" required>
            <option value="1">Active</option>
            <option value="0">Disabled</option>
          </select>
        </div>
        <div class="modal-actions">
          <button class="btn btn-outline-secondary" type="button" data-modal-close="editUserModal">Cancel</button>
          <button class="btn btn-outline-secondary" type="button" id="resetPasswordBtn">Reset Password</button>
          <button class="btn btn-primary" type="submit">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

</main>

<%- include('partials/footer', { scripts: ['/ui.js', 'users.js'], includeNavScript: true }) %>
